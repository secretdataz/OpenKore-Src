# -*-python-*-
Import('*')

XSTools_dir = '../auto/XSTools'

if not win32:
	dir = XSTools_dir + '/unix'

	e = env.Copy()
	e.Append(CPPPATH = dir)
	e.Append(LIBS = ['readline'])
	if have_ncurses:
		e.Append(LIBS = ['ncurses'])
	else:
		e.Append(LIBS = ['termcap'])
		e.Append(LIBPATH = ['/usr/lib/termcap'])
	e.Append(LINKFLAGS = ['-pthread'])
	e.Program('consoleui-test', [
		'consoleui-test.cpp',
		dir + '/consoleui.cpp'
	])
else:
	dir = XSTools_dir + '/utils'

	e = env.Copy()
	e.Append(CPPPATH = dir)
	e.Append(LIBS = ['wininet'])
	e.Program('http-reader-test', [
		'http-reader-test.cpp',
		dir + '/http-reader.cpp',
		dir + '/std-http-reader.cpp',
		dir + '/mirror-http-reader.cpp'
	])

dir = XSTools_dir + '/utils'
e = env.Copy()
e.Append(CPPPATH = dir)
if win32:
	e.Append(LIBS = ['wininet'])
else:
	e.ParseConfig('curl-config --cflags --libs')
	e.Append(LINKFLAGS = ['-pthread'])
e.Program('http-reader-test', [
	'http-reader-test.cpp',
	dir + '/http-reader.cpp',
	dir + '/std-http-reader.cpp',
	dir + '/mirror-http-reader.cpp'
])
